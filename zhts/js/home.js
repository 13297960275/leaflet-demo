"use strict";var map,chartColor=["#f9415f","#ffab40","#22b8dd","#52c138","#2276dd","#ef7c2f","#d5af17","#8744c0"],fontSize=13;function initMap(){L.mars.createMap({id:"map",data:{zoom:11,center:{x:117.35321,y:31.873532},minZoom:9,maxZoom:12,centerAutoLevel:15,copyright:!1,basemaps:[{name:"深色地图",type:"arcgis_tile",url:"http://map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer",visible:!0}],operationallayers:[]},success:function(t,a,e){map=t,initWork()}})}function initWork(){$.getJSON("../data/home/hefei.json",function(t){L.geoJson(t,{style:function(t){return{color:"#ffb408",weight:2,dashArray:"5 10",fill:!1}}}).addTo(map)}),$.getJSON("../data/home/point.json",function(t){layerPoint.loadData(t)})}$(document).ready(function(){initMap(),forResize(),$(window).resize(forResize),window.parent&&window.parent.setStyleByTheme&&(haoutil.storage.add("theme","gray"),window.parent.setStyleByTheme()),$.ajax({url:"../data/home/home.json",type:"get",dataType:"json",success:function(t){bindData2View(t)},error:function(t,a,e){haoutil.msg("home.json统计数据加载失败！")}});var t=$("#btn_ndtj_xms");$("#btn_ndtj_zjl").click(function(){t.removeClass("selected"),(t=$(this)).addClass("selected"),workChartNd.changeData("zjl")}),$("#btn_ndtj_zds").click(function(){t.removeClass("selected"),(t=$(this)).addClass("selected"),workChartNd.changeData("zds")}),$("#btn_ndtj_xms").click(function(){t.removeClass("selected"),(t=$(this)).addClass("selected"),workChartNd.changeData("xms")})});var layerPoint={layerWork:null,loadData:function(t){for(var a=0;a<t.length;a++)t[a].time=10*Math.random();this.layerWork=L.featureGroup(),map.addLayer(this.layerWork);var e=new mapv.DataSet(t),i={fillStyle:"rgba(255, 250, 0, 0.8)",size:3,bigData:"Point",draw:"simple"};L.mapVLayer(e,i).addTo(this.layerWork);e=new mapv.DataSet(t),i={fillStyle:"rgba(255, 250, 50, 0.6)",size:3,draw:"simple",bigData:"Point",animation:{type:"time",stepsRange:{start:0,end:10},trails:1,duration:6}};L.mapVLayer(e,i).addTo(this.layerWork)}};function forResize(){var t=($(window).height()-$("#dataCheck").height()-70)/2;$("#dataShow").height(20+t),$("#projectProgress").height(t-20);var a=($(window).height()-$("#typeTjView").height()-125)/2;$("#zijinTjView").height(a),$("#yearTjView").height(a),$("#echars_fzjly").height($("#echars_fzjly").parent().height()),$("#echars_fndxm").height($("#echars_fndxm").parent().height()-40),workChartZjly.resize(),workChartNd.resize()}function showTl(t){var a="";for(var e in t){a+='<li> <span style="background: '+t[e].color+';"></span><p>'+e+"</p></li>"}$("#tlView").html(a)}function bindData2View(t){$("#lbl_all_xms").html(t.zs.xms),$("#lbl_all_zds").html(t.zs.zds),$("#lbl_all_zjl").html(t.zs.zjl),$("#lbl_xmjd_xz").html(t.xmjd.xz.sl+"个"),$("#lbl_xmjd_xz_bfb").html(t.xmjd.xz.bfb+"%"),$("#lbl_xmjd_xz_bfb_bar").css({width:t.xmjd.xz.bfb+"%"}),$("#lbl_xmjd_tjz").html(t.xmjd.tjz.sl+"个"),$("#lbl_xmjd_tjz_bfb").html(t.xmjd.tjz.bfb+"%"),$("#lbl_xmjd_tjz_bfb_bar").css({width:t.xmjd.tjz.bfb+"%"}),$("#lbl_xmjd_yqgh").html(t.xmjd.yqgh.sl+"个"),$("#lbl_xmjd_yqgh_bfb").html(t.xmjd.yqgh.bfb+"%"),$("#lbl_xmjd_yqgh_bfb_bar").css({width:t.xmjd.yqgh.bfb+"%"}),$("#lbl_jzsj_ycl").html(t.jzsj.ycl),$("#lbl_jzsj_clz").html(t.jzsj.clz),$("#lbl_jzsj_wcl").html(t.jzsj.wcl);for(var a="",e=0;e<t.fltj.length;e++){var i=t.fltj[e];a+='<li class="clearfix">                        <p>'+i.name+"</p>                        <span><i>"+i.xms+"</i>个，投资<i>"+i.zds+"</i>亿，占地<i>"+i.zjl+"</i>亩</span>                   </li>"}$("#ul_fltj").html(a),workChartZjly.init(t.zjly),workChartNd.init(t.ndtj)}var workChartZjly={myChart:null,eleid:"echars_fzjly",arrdata:[],init:function(t){this.arrdata=t;var a=echarts.init(document.getElementById(this.eleid),"dark");a.setOption(this.getOption(this.arrdata)),this.myChart=a},resize:function(){this.myChart&&this.myChart.resize()},getOption:function(t){var a=[];for(var e in t)a.push(t[e].name);return{color:chartColor,tooltip:{trigger:"item",formatter:"{b} <br/> {c}亿 ({d}%)"},legend:{right:0,top:10,orient:"vertical",data:a,textStyle:{fontSize:fontSize}},series:[{name:"分资金来源项目统计",type:"pie",radius:"80%",center:["35%","50%"],data:t,itemStyle:{normal:{label:{show:!1,textStyle:{fontSize:fontSize},formatter:function(t){return t.name+""+t.value+"亿"}}}}}]}}},workChartNd={myChart:null,eleid:"echars_fndxm",unit:"个",alldata:{},arrdata:[],init:function(t){this.alldata=t;var a=echarts.init(document.getElementById(this.eleid),"dark");this.myChart=a,this.changeData()},changeData:function(t){switch(t){default:case"xms":this.arrdata=this.alldata.xms,this.unit="个";break;case"zds":this.arrdata=this.alldata.zds,this.unit="亩";break;case"zjl":this.arrdata=this.alldata.zjl,this.unit="亿"}this.myChart.clear(),this.myChart.setOption(this.getOption())},resize:function(){this.myChart&&this.myChart.resize()},getOption:function(){var t=this.arrdata;$("#lbl_ndtj_dw").html("单位："+this.unit);for(var a=[],e=[],i=0;i<t.length;i++)a.push(t[i].name),e.push(t[i].value);return{color:chartColor,tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:"{b}年 {c} "+this.unit},grid:{top:"10px",bottom:"10px",left:"5px",right:"5px",containLabel:!0},xAxis:[{type:"category",data:a,axisTick:{alignWithLabel:!0},axisLabel:{textStyle:{fontSize:fontSize}}}],yAxis:[{type:"value",name:this.unit,nameTextStyle:{fontSize:fontSize},axisLabel:{textStyle:{fontSize:fontSize}}}],series:[{name:"分年度统计",type:"bar",barWidth:"20%",itemStyle:{normal:{label:{show:!1}}},data:e}]}}};