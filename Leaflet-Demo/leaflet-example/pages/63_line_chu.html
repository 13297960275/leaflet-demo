
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,layer,haoutil,echarts-forleaflet,leaflet-src,esri-leaflet"></script><link href="css/style.css" rel="stylesheet"></head><body><div id="map" class="map"></div><script>var map;function initMap(){var e=haoutil.system.getRequestByName("config","config/gcj.json");L.src.createMap({id:"map",url:e,success:function(e,a){map=e,initWork()}})}function initWork(){workEcharts.create(map),workEcharts.activate()}$(document).ready(function(){initMap()});var workEcharts={layerWork:null,create:function(e){this.map=e,this.path=""},activate:function(){map.setView([33.652,107.661],4),this.showData()},disable:function(){map.removeLayer(this.layerWork),this.layerWork=null},showData:function(e){var a=this.getOption(e);null==this.layerWork?this.layerWork=L.flowEcharts(a).addTo(map):(this.layerWork._echartsOption=a,this.layerWork.redraw())},getOption:function(e){var l={"安徽省":[117.17,31.52],"北京市":[116.24,39.55],"重庆市":[106.54,29.59],"福建省":[119.18,26.05],"甘肃省":[103.51,36.04],"广东省":[113.14,23.08],"广西壮族自治区":[108.19,22.48],"贵州省":[106.42,26.35],"海南省":[110.2,20.02],"河北省":[114.3,38.02],"河南省":[113.4,34.46],"黑龙江省":[128.36,45.44],"湖北省":[112.27,30.15],"湖南省":[112.59,28.12],"吉林省":[125.19,43.54],"江苏省":[118.46,32.03],"江西省":[115.55,28.4],"辽宁省":[123.25,41.48],"内蒙古":[108.41,40.48],"宁夏回族自治区":[106.16,38.27],"青海省":[101.48,36.38],"山东省":[118,36.4],"山西省":[112.33,37.54],"陕西省":[108.57,34.17],"上海市":[121.29,31.14],"海南":[108.77,19.1],"四川省":[104.04,30.4],"天津市":[117.12,39.02],"西藏自治区":[91.08,29.39],"新疆维吾尔自治区":[87.36,43.45],"云南省":[102.42,25.04],"浙江省":[120.1,30.16],"澳门":[115.07,21.33],"台湾省":[121.21,23.53]},t=function(e){for(var a=[],t=0;t<e.length;t++){var n=e[t],r=l[n[0].name],o=l[n[1].name];r&&o&&a.push({fromName:n[0].name,toName:n[1].name,coords:[r,o]})}return a},n=["#a6c84c","#ffa022","#46bee9"],r=[];return[["",[[{name:"北京市"},{name:"上海市",value:195}],[{name:"北京市"},{name:"广东省",value:90}],[{name:"北京市"},{name:"辽宁省",value:80}],[{name:"北京市"},{name:"湖北省",value:70}],[{name:"北京市"},{name:"内蒙古",value:70}],[{name:"北京市"},{name:"江苏省",value:60}],[{name:"北京市"},{name:"新疆维吾尔自治区",value:70}],[{name:"北京市"},{name:"四川省",value:40}],[{name:"北京市"},{name:"云南省",value:130}],[{name:"北京市"},{name:"黑龙江省",value:130}],[{name:"北京市"},{name:"甘肃省",value:200}],[{name:"北京市"},{name:"西藏自治区",value:60}]]]].forEach(function(e,a){r.push({name:e[0],type:"lines",zlevel:1,effect:{show:!0,period:6,trailLength:.7,color:"#fff",symbolSize:3},lineStyle:{normal:{color:n[0],width:0,curveness:.2}},data:t(e[1])},{name:e[0],type:"lines",zlevel:2,effect:{show:!0,period:6,trailLength:.1,symbol:"arrow",symbolSize:5},lineStyle:{normal:{color:n[1],width:1,opacity:.4,curveness:.2}},data:t(e[1])},{name:e[0],type:"effectScatter",coordinateSystem:"geo",zlevel:2,rippleEffect:{brushType:"stroke"},label:{normal:{show:!0,position:"right",formatter:"{b}"}},symbolSize:function(e){return e[2]/6},itemStyle:{normal:{color:function(e){var a=e.data.value[2];return a<100?"green":150<a?"red":"yellow"}}},data:e[1].map(function(e){return{name:e[1].name,value:l[e[1].name].concat([e[1].value])}})})}),option={backgroundColor:"rgba(116, 112, 124, 0.2)",title:{text:"北京病人就诊流向图",subtext:"(1月份统计结果)",left:"center",textStyle:{color:"#fff"},subtextStyle:{color:"yellow",fontWeight:"bold"}},tooltip:{trigger:"item",formatter:function(e){return 2==e.seriesIndex||5==e.seriesIndex||8==e.seriesIndex?e.name+"<br>"+e.seriesName+":"+e.data.value[2]+" 人次":1==e.seriesIndex||4==e.seriesIndex||7==e.seriesIndex?e.data.fromName+"→"+e.data.toName:void 0}},legend:{orient:"vertical",top:"6%",left:"center",data:["北京市"],textStyle:{color:"#fff"},selectedMode:"single"},geo:{map:"",roam:!0},series:r},option}}</script></body></html>