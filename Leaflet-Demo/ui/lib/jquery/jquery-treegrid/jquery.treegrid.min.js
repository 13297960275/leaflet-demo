
!function(d){var t={initTree:function(e){var t=d.extend({},this.treegrid.defaults,e);return this.each(function(){var e=d(this);e.treegrid("setTreeContainer",d(this)),e.treegrid("setSettings",t),t.getRootNodes.apply(this,[d(this)]).treegrid("initNode",t),e.treegrid("getRootNodes").treegrid("render")})},initNode:function(t){return this.each(function(){var e=d(this);e.treegrid("setTreeContainer",t.getTreeGridContainer.apply(this)),e.treegrid("getChildNodes").treegrid("initNode",t),e.treegrid("initExpander").treegrid("initIndent").treegrid("initEvents").treegrid("initState").treegrid("initChangeEvent").treegrid("initSettingsEvents")})},initChangeEvent:function(){var e=d(this);return e.on("change",function(){var e=d(this);e.treegrid("render"),e.treegrid("getSetting","saveState")&&e.treegrid("saveState")}),e},initEvents:function(){var e=d(this);return e.on("collapse",function(){var e=d(this);e.removeClass("treegrid-expanded"),e.addClass("treegrid-collapsed")}),e.on("expand",function(){var e=d(this);e.removeClass("treegrid-collapsed"),e.addClass("treegrid-expanded")}),e},initSettingsEvents:function(){var e=d(this);return e.on("change",function(){var e=d(this);"function"==typeof e.treegrid("getSetting","onChange")&&e.treegrid("getSetting","onChange").apply(e)}),e.on("collapse",function(){var e=d(this);"function"==typeof e.treegrid("getSetting","onCollapse")&&e.treegrid("getSetting","onCollapse").apply(e)}),e.on("expand",function(){var e=d(this);"function"==typeof e.treegrid("getSetting","onExpand")&&e.treegrid("getSetting","onExpand").apply(e)}),e},initExpander:function(){var e=d(this),t=e.find("td").get(e.treegrid("getSetting","treeColumn")),r=e.treegrid("getSetting","expanderTemplate"),i=e.treegrid("getSetting","getExpander").apply(this);return i&&i.remove(),d(r).prependTo(t).click(function(){d(d(this).closest("tr")).treegrid("toggle")}),e},initIndent:function(){var e=d(this);e.find(".treegrid-indent").remove();for(var t=e.treegrid("getSetting","indentTemplate"),r=e.find(".treegrid-expander"),i=e.treegrid("getDepth"),n=0;n<i;n++)d(t).insertBefore(r);return e},initState:function(){var e=d(this);return e.treegrid(e.treegrid("getSetting","saveState")&&!e.treegrid("isFirstInit")?"restoreState":"expanded"===e.treegrid("getSetting","initialState")?"expand":"collapse"),e},isFirstInit:function(){var e=d(this).treegrid("getTreeContainer");return void 0===e.data("first_init")&&e.data("first_init",void 0===d.cookie(e.treegrid("getSetting","saveStateName"))),e.data("first_init")},saveState:function(){var e=d(this);if("cookie"===e.treegrid("getSetting","saveStateMethod")){var t=d.cookie(e.treegrid("getSetting","saveStateName"))||"",r=""===t?[]:t.split(","),i=e.treegrid("getNodeId");e.treegrid("isExpanded")?-1===d.inArray(i,r)&&r.push(i):e.treegrid("isCollapsed")&&-1!==d.inArray(i,r)&&r.splice(d.inArray(i,r),1),d.cookie(e.treegrid("getSetting","saveStateName"),r.join(","))}return e},restoreState:function(){var e=d(this);if("cookie"===e.treegrid("getSetting","saveStateMethod")){var t=d.cookie(e.treegrid("getSetting","saveStateName")).split(",");e.treegrid(-1!==d.inArray(e.treegrid("getNodeId"),t)?"expand":"collapse")}return e},getSetting:function(e){return d(this).treegrid("getTreeContainer")?d(this).treegrid("getTreeContainer").data("settings")[e]:null},setSettings:function(e){d(this).treegrid("getTreeContainer").data("settings",e)},getTreeContainer:function(){return d(this).data("treegrid")},setTreeContainer:function(e){return d(this).data("treegrid",e)},getRootNodes:function(){return d(this).treegrid("getSetting","getRootNodes").apply(this,[d(this).treegrid("getTreeContainer")])},getAllNodes:function(){return d(this).treegrid("getSetting","getAllNodes").apply(this,[d(this).treegrid("getTreeContainer")])},isNode:function(){return null!==d(this).treegrid("getNodeId")},getNodeId:function(){return null===d(this).treegrid("getSetting","getNodeId")?null:d(this).treegrid("getSetting","getNodeId").apply(this)},getParentNodeId:function(){return d(this).treegrid("getSetting","getParentNodeId").apply(this)},getParentNode:function(){return null===d(this).treegrid("getParentNodeId")?null:d(this).treegrid("getSetting","getNodeById").apply(this,[d(this).treegrid("getParentNodeId"),d(this).treegrid("getTreeContainer")])},getChildNodes:function(){return d(this).treegrid("getSetting","getChildNodes").apply(this,[d(this).treegrid("getNodeId"),d(this).treegrid("getTreeContainer")])},getDepth:function(){return null===d(this).treegrid("getParentNode")?0:d(this).treegrid("getParentNode").treegrid("getDepth")+1},isRoot:function(){return 0===d(this).treegrid("getDepth")},isLeaf:function(){return 0===d(this).treegrid("getChildNodes").length},isLast:function(){if(d(this).treegrid("isNode")){var e=d(this).treegrid("getParentNode");if(null===e){if(d(this).treegrid("getNodeId")===d(this).treegrid("getRootNodes").last().treegrid("getNodeId"))return!0}else if(d(this).treegrid("getNodeId")===e.treegrid("getChildNodes").last().treegrid("getNodeId"))return!0}return!1},isFirst:function(){if(d(this).treegrid("isNode")){var e=d(this).treegrid("getParentNode");if(null===e){if(d(this).treegrid("getNodeId")===d(this).treegrid("getRootNodes").first().treegrid("getNodeId"))return!0}else if(d(this).treegrid("getNodeId")===e.treegrid("getChildNodes").first().treegrid("getNodeId"))return!0}return!1},isExpanded:function(){return d(this).hasClass("treegrid-expanded")},isCollapsed:function(){return d(this).hasClass("treegrid-collapsed")},isOneOfParentsCollapsed:function(){var e=d(this);return!e.treegrid("isRoot")&&(!!e.treegrid("getParentNode").treegrid("isCollapsed")||e.treegrid("getParentNode").treegrid("isOneOfParentsCollapsed"))},expand:function(){return this.treegrid("isLeaf")||this.treegrid("isExpanded")||(this.trigger("expand"),this.trigger("change")),this},expandAll:function(){var e=d(this);return e.treegrid("getRootNodes").treegrid("expandRecursive"),e},expandRecursive:function(){return d(this).each(function(){var e=d(this);e.treegrid("expand"),e.treegrid("isLeaf")||e.treegrid("getChildNodes").treegrid("expandRecursive")})},collapse:function(){return d(this).each(function(){var e=d(this);e.treegrid("isLeaf")||e.treegrid("isCollapsed")||(e.trigger("collapse"),e.trigger("change"))})},collapseAll:function(){var e=d(this);return e.treegrid("getRootNodes").treegrid("collapseRecursive"),e},collapseRecursive:function(){return d(this).each(function(){var e=d(this);e.treegrid("collapse"),e.treegrid("isLeaf")||e.treegrid("getChildNodes").treegrid("collapseRecursive")})},toggle:function(){var e=d(this);return e.treegrid(e.treegrid("isExpanded")?"collapse":"expand"),e},render:function(){return d(this).each(function(){var e=d(this);e.treegrid("isOneOfParentsCollapsed")?e.hide():e.show(),e.treegrid("isLeaf")||(e.treegrid("renderExpander"),e.treegrid("getChildNodes").treegrid("render"))})},renderExpander:function(){return d(this).each(function(){var e=d(this),t=e.treegrid("getSetting","getExpander").apply(this);t?e.treegrid("isCollapsed")?(t.removeClass(e.treegrid("getSetting","expanderExpandedClass")),t.addClass(e.treegrid("getSetting","expanderCollapsedClass"))):(t.removeClass(e.treegrid("getSetting","expanderCollapsedClass")),t.addClass(e.treegrid("getSetting","expanderExpandedClass"))):(e.treegrid("initExpander"),e.treegrid("renderExpander"))})}};d.fn.treegrid=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void d.error("Method with name "+e+" does not exists for jQuery.treegrid"):t.initTree.apply(this,arguments)},d.fn.treegrid.defaults={initialState:"expanded",saveState:!1,saveStateMethod:"cookie",saveStateName:"tree-grid-state",expanderTemplate:'<span class="treegrid-expander"></span>',indentTemplate:'<span class="treegrid-indent"></span>',expanderExpandedClass:"treegrid-expander-expanded",expanderCollapsedClass:"treegrid-expander-collapsed",treeColumn:0,getExpander:function(){return d(this).find(".treegrid-expander")},getNodeId:function(){var e=/treegrid-([A-Za-z0-9_-]+)/;return e.test(d(this).attr("class"))?e.exec(d(this).attr("class"))[1]:null},getParentNodeId:function(){var e=/treegrid-parent-([A-Za-z0-9_-]+)/;return e.test(d(this).attr("class"))?e.exec(d(this).attr("class"))[1]:null},getNodeById:function(e,t){var r="treegrid-"+e;return t.find("tr."+r)},getChildNodes:function(e,t){var r="treegrid-parent-"+e;return t.find("tr."+r)},getTreeGridContainer:function(){return d(this).closest("table")},getRootNodes:function(e){var t=d.grep(e.find("tr"),function(e){var t=d(e).attr("class");return/treegrid-([A-Za-z0-9_-]+)/.test(t)&&!/treegrid-parent-([A-Za-z0-9_-]+)/.test(t)});return d(t)},getAllNodes:function(e){var t=d.grep(e.find("tr"),function(e){var t=d(e).attr("class");return/treegrid-([A-Za-z0-9_-]+)/.test(t)});return d(t)},onCollapse:null,onExpand:null,onChange:null}}(jQuery);