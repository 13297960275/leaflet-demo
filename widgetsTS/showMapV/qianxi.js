L.widget.bindClass(L.widget.BaseWidget.extend({options:{},layerWork:null,create:function(){this.layerWork=L.featureGroup()},activate:function(){map.changeBaseMap("谷歌卫星"),map.addLayer(this.layerWork);var a=this;$.ajax({url:"data/geojson/china.json",type:"GET",dataType:"json",success:function(t){a.isActivate&&a.showMapV(t)}})},disable:function(){map.changeBaseMap(0),map.removeLayer(this.layerWork)},showMapV:function(t){map.setView([33.468108,112.939453],5);for(var a=mapv.geojson.getDataSet(t),e="北京",o=new mapv.DataSet([{from:"河北",count:354551,to:e},{from:"天津",count:97323,to:e},{from:"山东",count:28664,to:e},{from:"山西",count:16650,to:e},{from:"辽宁",count:14379,to:e},{from:"河南",count:10980,to:e},{from:"内蒙古自治区",count:9603,to:e},{from:"江苏",count:4536,to:e},{from:"上海",count:3556,to:e},{from:"广东",count:2600,to:e}]).get(),r=[],n=[],i=[],s=[],l={},m=0;m<o.length;m++){var d=mapv.utilCityCenter.getCenterByCityName(o[m].from),p=mapv.utilCityCenter.getCenterByCityName(o[m].to);if(d&&p){l[o[m].from]=o[m].count,l[o[m].to]=100,n.push({geometry:{type:"Point",coordinates:[d.lng,d.lat]}}),n.push({geometry:{type:"Point",coordinates:[p.lng,p.lat]}}),i.push({geometry:{type:"Point",coordinates:[d.lng,d.lat]},text:o[m].from}),i.push({geometry:{type:"Point",coordinates:[p.lng,p.lat]},text:o[m].to});var y=mapv.utilCurve.getPoints([d,p]);for(j=0;j<y.length;j++)s.push({geometry:{type:"Point",coordinates:y[j]},count:1,time:j});r.push({geometry:{type:"LineString",coordinates:y},count:30*Math.random()})}}var u=a.get({filter:function(t){return!!l[t.name]&&(t.count=l[t.name],!0)}});a=new mapv.DataSet(u),L.mapVLayer(a,{gradient:{0:"rgba(55, 50, 250, 0.4)",1:"rgba(55, 50, 250, 1)"},max:354551,draw:"intensity"}).addTo(this.layerWork);var g=new mapv.DataSet(i);L.mapVLayer(g,{draw:"text",font:"14px Arial",fillStyle:"white",shadowColor:"yellow",shadowBlue:10,zIndex:11,shadowBlur:10}).addTo(this.layerWork);var c=new mapv.DataSet(r);L.mapVLayer(c,{strokeStyle:"rgba(255, 250, 50, 0.8)",shadowColor:"rgba(255, 250, 50, 1)",shadowBlur:20,lineWidth:2,zIndex:100,draw:"simple"}).addTo(this.layerWork);var h=new mapv.DataSet(n);L.mapVLayer(h,{fillStyle:"rgba(254,175,3,0.7)",shadowColor:"rgba(55, 50, 250, 0.5)",shadowBlur:10,size:5,zIndex:10,draw:"simple"}).addTo(this.layerWork);var f=new mapv.DataSet(s);L.mapVLayer(f,{fillStyle:"rgba(255, 250, 250, 0.5)",zIndex:200,size:2.5,animation:{type:"time",stepsRange:{start:0,end:50},trails:10,duration:2},draw:"simple"}).addTo(this.layerWork)}}));