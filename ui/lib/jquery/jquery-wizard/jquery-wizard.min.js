/* 2018-3-10 12:34:16 | 版权所有 合肥火星科技有限公司 http://www.marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
!function(r,t,e,o){"use strict";function n(t,i){var e=!1;t.one(s.transition.end,function(){e=!0});setTimeout(function(){e||t.trigger(s.transition.end)},i)}function i(){return this.initialize.apply(this,Array.prototype.slice.call(arguments))}var s=function(){function t(t,i){var e=!1,n=t.charAt(0).toUpperCase()+t.slice(1);return s[t]!==o&&(e=t),e||r.each(a,function(t,i){return s[i+n]!==o?(e="-"+i.toLowerCase()+"-"+n,!1):void 0}),i?e:!!e}var s=r("<support>").get(0).style,a=["webkit","Moz","O","ms"],i={};return function(){return!!t("transition")}()&&(i.transition=new String(t("transition",!0)),i.transition.end={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"}[i.transition]),i}(),a=0,h=function(t,i){this.$element=r(t),this.options=r.extend(!0,{},h.defaults,i),this.$steps=this.$element.find(this.options.step),this.id=this.$element.attr("id"),this.id||(this.id="wizard-"+ ++a,this.$element.attr("id",this.id)),this.initialize()};h.defaults={step:".wizard-steps > li",getPane:function(t,i){return this.$element.find(".wizard-content").children().eq(t)},buttonsAppendTo:"this",templates:{buttons:function(){var t=this.options;return'<div class="wizard-buttons"><a class="wizard-back" href="#'+this.id+'" data-wizard="back" role="button">'+t.buttonLabels.back+'</a><a class="wizard-next" href="#'+this.id+'" data-wizard="next" role="button">'+t.buttonLabels.next+'</a><a class="wizard-finish" href="#'+this.id+'" data-wizard="finish" role="button">'+t.buttonLabels.finish+"</a></div>"}},classes:{step:{done:"done",error:"error",active:"current",disabled:"disabled",activing:"activing",loading:"loading"},pane:{active:"active",activing:"activing"},button:{hide:"hide",disabled:"disabled"}},autoFocus:!0,keyboard:!0,enableWhenVisited:!1,buttonLabels:{next:"Next",back:"Back",finish:"Finish"},loading:{show:function(t){},hide:function(t){},fail:function(t){}},cacheContent:!1,validator:function(t){return!0},onInit:null,onNext:null,onBack:null,onReset:null,onBeforeShow:null,onAfterShow:null,onBeforeHide:null,onAfterHide:null,onBeforeLoad:null,onAfterLoad:null,onBeforeChange:null,onAfterChange:null,onStateChange:null,onFinish:null},r.extend(i.prototype,{TRANSITION_DURATION:200,initialize:function(t,i,e){this.$element=r(t),this.wizard=i,this.events={},this.loader=null,this.loaded=!1,this.validator=this.wizard.options.validator,this.states={done:!1,error:!1,active:!1,disabled:!1,activing:!1},this.index=e,this.$element.data("wizard-index",e),this.$pane=this.getPaneFromTarget(),this.$pane||(this.$pane=this.wizard.options.getPane.call(this.wizard,e,t)),this.setValidatorFromData(),this.setLoaderFromData()},getPaneFromTarget:function(){var t=this.$element.data("target");return t||(t=(t=this.$element.attr("href"))&&t.replace(/.*(?=#[^\s]*$)/,"")),t?r(t):null},setup:function(){var t=this.wizard.currentIndex();this.index===t?(this.enter("active"),this.loader&&this.load()):this.index>t&&this.enter("disabled"),this.$element.attr("aria-expanded",this.is("active")),this.$pane.attr("aria-expanded",this.is("active"));var i=this.wizard.options.classes;this.is("active")?this.$pane.addClass(i.pane.active):this.$pane.removeClass(i.pane.active)},show:function(t){if(!this.is("activing")&&!this.is("active")){this.trigger("beforeShow"),this.enter("activing");var i=this.wizard.options.classes;this.$element.attr("aria-expanded",!0),this.$pane.addClass(i.pane.activing).addClass(i.pane.active).attr("aria-expanded",!0);var e=function(){this.$pane.removeClass(i.pane.activing),this.leave("activing"),this.enter("active"),this.trigger("afterShow"),r.isFunction(t)&&t.call(this)};if(!s.transition)return e.call(this);this.$pane.one(s.transition.end,r.proxy(e,this)),n(this.$pane,this.TRANSITION_DURATION)}},hide:function(t){if(!this.is("activing")&&this.is("active")){this.trigger("beforeHide"),this.enter("activing");var i=this.wizard.options.classes;this.$element.attr("aria-expanded",!1),this.$pane.addClass(i.pane.activing).removeClass(i.pane.active).attr("aria-expanded",!1);var e=function(){this.$pane.removeClass(i.pane.activing),this.leave("activing"),this.leave("active"),this.trigger("afterHide"),r.isFunction(t)&&t.call(this)};if(!s.transition)return e.call(this);this.$pane.one(s.transition.end,r.proxy(e,this)),n(this.$pane,this.TRANSITION_DURATION)}},empty:function(){this.$pane.empty()},load:function(i){function e(t){n.$pane.html(t),n.leave("loading"),n.loaded=!0,n.trigger("afterLoad"),r.isFunction(i)&&i.call(n)}var n=this,t=this.loader;return r.isFunction(t)&&(t=t.call(this.wizard,this)),this.wizard.options.cacheContent&&this.loaded?(r.isFunction(i)&&i.call(this),!0):(this.trigger("beforeLoad"),this.enter("loading"),void("string"==typeof t?e(t):"object"==typeof t&&t.hasOwnProperty("url")?(n.wizard.options.loading.show.call(n.wizard,n),r.ajax(t.url,t.settings||{}).done(function(t){e(t),n.wizard.options.loading.hide.call(n.wizard,n)}).fail(function(){n.wizard.options.loading.fail.call(n.wizard,n)})):e("")))},trigger:function(t){var i=Array.prototype.slice.call(arguments,1);if(r.isArray(this.events[t]))for(var e in this.events[t])this.events[t][e].apply(this,i);this.wizard.trigger.apply(this.wizard,[t,this].concat(i))},enter:function(t){this.states[t]=!0;var i=this.wizard.options.classes;this.$element.addClass(i.step[t]),this.trigger("stateChange",!0,t)},leave:function(t){if(this.states[t]){this.states[t]=!1;var i=this.wizard.options.classes;this.$element.removeClass(i.step[t]),this.trigger("stateChange",!1,t)}},setValidatorFromData:function(){var t=this.$pane.data("validator");t&&r.isFunction(e[t])&&(this.validator=e[t])},setLoaderFromData:function(){var t=this.$pane.data("loader");if(t)r.isFunction(e[t])&&(this.loader=e[t]);else{var i=this.$pane.data("loader-url");i&&(this.loader={url:i,settings:this.$pane.data("settings")||{}})}},active:function(){return this.wizard.goTo(this.index)},on:function(t,i){return r.isFunction(i)&&(r.isArray(this.events[t])?this.events[t].push(i):this.events[t]=[i]),this},off:function(e,n){return r.isFunction(n)&&r.isArray(this.events[e])&&r.each(this.events[e],function(t,i){return i===n?(delete this.events[e][t],!1):void 0}),this},is:function(t){return this.states[t]&&!0===this.states[t]},reset:function(){for(var t in this.states)this.leave(t);return this.setup(),this},setLoader:function(t){return this.loader=t,this.is("active")&&this.load(),this},setValidator:function(t){return r.isFunction(t)&&(this.validator=t),this},validate:function(){return this.validator.call(this.$pane.get(0),this)}}),r.extend(h.prototype,{Constructor:h,initialize:function(){this.steps=[];var e=this;this.$steps.each(function(t){e.steps.push(new i(this,e,t))}),this._current=0,this.transitioning=null,r.each(this.steps,function(t,i){i.setup()}),this.setup(),this.$element.on("click",this.options.step,function(t){var i=r(this).data("wizard-index");e.get(i).is("disabled")||e.goTo(i),t.preventDefault(),t.stopPropagation()}),this.options.keyboard&&r(t).on("keyup",r.proxy(this.keydown,this)),this.trigger("init")},setup:function(){this.$buttons=r(this.options.templates.buttons.call(this)),this.updateButtons();var t,i=this.options.buttonsAppendTo;t="this"===i?this.$element:r.isFunction(i)?i.call(this):this.$element.find(i),this.$buttons=this.$buttons.appendTo(t)},updateButtons:function(){var t=this.options.classes.button,i=this.$buttons.find('[data-wizard="back"]'),e=this.$buttons.find('[data-wizard="next"]'),n=this.$buttons.find('[data-wizard="finish"]');0===this._current?i.addClass(t.disabled):i.removeClass(t.disabled),this._current===this.lastIndex()?(e.addClass(t.hide),n.removeClass(t.hide)):(e.removeClass(t.hide),n.addClass(t.hide))},updateSteps:function(){var e=this;r.each(this.steps,function(t,i){t>e._current&&(i.leave("error"),i.leave("active"),i.leave("done"),e.options.enableWhenVisited||i.enter("disabled"))})},keydown:function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.back();break;case 39:this.next();break;default:return}t.preventDefault()}},trigger:function(t){var i=Array.prototype.slice.call(arguments,1),e=[this].concat(i);this.$element.trigger("wizard::"+t,e);var n="on"+(t=t.replace(/\b\w+\b/g,function(t){return t.substring(0,1).toUpperCase()+t.substring(1)}));"function"==typeof this.options[n]&&this.options[n].apply(this,i)},get:function(t){if("string"==typeof t&&"#"===t.substring(0,1)){var i=t.substring(1);for(var e in this.steps)if(this.steps[e].$pane.attr("id")===i)return this.steps[e]}return t<this.length()&&this.steps[t]?this.steps[t]:null},goTo:function(i,e){if(i===this._current||!0===this.transitioning)return!1;var n=this.current(),s=this.get(i);if(i>this._current){if(!n.validate())return n.leave("done"),n.enter("error"),-1;n.leave("error"),i>this._current&&n.enter("done")}var a=this,t=function(){a.trigger("beforeChange",n,s),a.transitioning=!0,n.hide(),s.show(function(){if(a._current=i,a.transitioning=!1,this.leave("disabled"),a.updateButtons(),a.updateSteps(),a.options.autoFocus){var t=this.$pane.find(":input");0<t.length?t.eq(0).focus():this.$pane.focus()}r.isFunction(e)&&e.call(a),a.trigger("afterChange",n,s)})};return s.loader?s.load(function(){t()}):t(),!0},length:function(){return this.steps.length},current:function(){return this.get(this._current)},currentIndex:function(){return this._current},lastIndex:function(){return this.length()-1},next:function(){if(this._current<this.lastIndex()){var t=this._current,i=this._current+1;this.goTo(i,function(){this.trigger("next",this.get(t),this.get(i))})}return!1},back:function(){if(0<this._current){var t=this._current,i=this._current-1;this.goTo(i,function(){this.trigger("back",this.get(t),this.get(i))})}return!1},first:function(){return this.goTo(0)},finish:function(){if(this._current===this.lastIndex()){var t=this.current();t.validate()?(this.trigger("finish"),t.leave("error"),t.enter("done")):t.enter("error")}},reset:function(){this._current=0,r.each(this.steps,function(t,i){i.reset()}),this.trigger("reset")}}),r(t).on("click","[data-wizard]",function(t){var i,e=r(this),n=r(e.attr("data-target")||(i=e.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")).data("wizard");if(n){var s=e.data("wizard");/^(back|next|first|finish|reset)$/.test(s)&&n[s](),t.preventDefault()}}),r.fn.wizard=function(t){if("string"!=typeof t)return this.each(function(){r.data(this,"wizard")||r.data(this,"wizard",new h(this,t))});var i=t,e=Array.prototype.slice.call(arguments,1);if(/^\_/.test(i))return!1;if(!/^(get)$/.test(i))return this.each(function(){var t=r.data(this,"wizard");t&&"function"==typeof t[i]&&t[i].apply(t,e)});var n=this.first().data("wizard");return n&&"function"==typeof n[i]?n[i].apply(n,e):void 0}}(jQuery,document,window);