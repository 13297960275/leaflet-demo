/* 2018-3-10 12:34:16 | 版权所有 合肥火星科技有限公司 http://www.marsgis.cn  【联系我们QQ：516584683，微信：marsgis】 */
var LTGrid=function(t){"use strict";var e,i,n,o,s,r,d=function(){function t(t){this.rects=t||[]}return t.prototype.getIntersectingRects=function(e){return this.rects.filter(function(t){return e!==t&&e.intersect(t)})},t.prototype.compact=function(){var t=this.rects.slice(0),e=this;return t.sort(function(t,e){return t.y-e.y}).forEach(function(t){for(;t.y-=1,0<=t.y&&0===e.getIntersectingRects(t).length;);t.y+=1}),this},t.prototype.height=function(){var t=this.rects.map(function(t){return t.bottom()});return t.length?Math.max.apply(null,t):0},t.prototype.updateNoOverlap=function(e,t){var i=this;return this.update(e,t),this.getIntersectingRects(e).forEach(function(t){i.updateNoOverlap(t,{x:t.x,y:e.bottom()})}),this},t.prototype.update=function(t,e){return t.x="x"in e?e.x:t.x,t.y="y"in e?e.y:t.y,t.w="w"in e?e.w:t.w,t.h="h"in e?e.h:t.h,this},t}(),a=(o=jQuery,r={NAME:s="ltData",getRects:function(t){return o.map(t,function(t){return new g(t.x,t.y,t.w,t.h)})}},o.fn[s]=function(t,e){var i=this[a.NAME]().data(a.DATA_KEY);return void 0!==e?(i.grid(t,new d(r.getRects(e))).update(),this):i.grid(t).rects},function(h){function a(t,e){this.$element=h(t),this._options=this._getOptions(e||{}),this.$mask=void 0,this.$ghost=void 0}var p="ltGrid",c="lt.grid",t="."+c,e={START:"dragstart."+t+" touchstart. "+t,OVER:"dragover."+t+" touchmove. "+t,END:"dragend."+t+" touchcancel. "+t,DROP:"drop."+t+" touchend. "+t,LEAVE:"dragleave."+t},i='[data-arrange="lt-grid"]',n='[data-arrange="lt-grid"] .lt',u={resize:!0,overlap:!1,compact:!0,params:{lg:{gap:1,maxWidth:Number.MAX_VALUE,cols:4,aspect:2/3},md:{gap:2,maxWidth:1200,cols:3,aspect:2/3},sm:{gap:3,maxWidth:992,cols:2,aspect:2/3},xs:{gap:4,maxWidth:768,cols:1,aspect:2/3}}};return a.Default=u,a.NAME=p,a.DATA_KEY=c,a.EVENT_KEY=t,a.prototype.options=function(){return this._options},a.prototype.option=function(t,e){this._options[t]=e},a.prototype.size=function(){var t,e=this._windowWidth();for(var i in this._options.params)e<this._options.params[i].maxWidth&&(t=i);return t},a.prototype.compact=function(){var t=this.size(),e=this.grid(t);this.grid(t,e.compact())},a.prototype.resize=function(){var t=this.size(),e=new g(0,0,0,this.grid(t).height()).setCss(this.$element.attr("class"),t);this.$element.attr("class",e)},a.prototype.end=function(){this._removeMask(),this._removeGhost(),this.update()},a.prototype.update=function(){this._options.compact&&this.compact(),this._options.resize&&this.resize()},a.prototype.grid=function(i,t){var n=this.$element.children("[draggable]");return void 0!==t?(t.rects.forEach(function(t,e){n.eq(e)[f.NAME](i,t)}),this):new d(h.map(n.toArray(),function(t){return h(t)[f.NAME](i)}))},a.prototype.reposition=function(t,e){var i=this.size(),n=t[f.NAME](i),o=this.grid(i);this._options.overlap?o.update(n,e):o.updateNoOverlap(n,e),this.grid(i,o),this.update()},a.prototype._moveGhost=function(t,e,i){var n=this.size(),o=this._getGhost(t),s=o[f.NAME](n),r=this._options.params[n].gap,a=this._options.params[n].cols;s.x=Math.floor(e/(this._itemWidth(n)+r)),s.y=Math.floor(i/(this._itemHeight(n)+r)),s.x=Math.min(Math.max(0,s.x),a-s.w),o[f.NAME](n,s)},a.prototype._getGhost=function(t){return void 0===this.$ghost&&(this.$ghost=h('<div class="'+t.attr("class")+' lt-ghost"></div>'),this.$element.append(this.$ghost)),this.$ghost},a.prototype._removeGhost=function(){this.$ghost&&(this.$ghost.remove(),this.$ghost=void 0)},a.prototype._moveToGhost=function(t){var e=this.size(),i=t.parent(),n=this._getGhost(t)[f.NAME](e);this.$element.append(t),this.reposition(t,{x:n.x,y:n.y}),i.add(this.$element)[p]("update")},a.prototype._getMask=function(){return void 0===this.$mask&&(this.$mask=h('<div class="lt-mask" data-lt-grid="mask"></div>'),this.$element.append(this.$mask)),this.$mask},a.prototype._removeMask=function(){void 0!==this.$mask&&(this.$mask.remove(),this.$mask=void 0)},a.prototype._itemWidth=function(t){var e=this._options.params[t].cols,i=this._options.params[t].gap;return(this.$element.width()-(e-1)*i)/e},a.prototype._itemHeight=function(t){var e=this._options.params[t].aspect;return this._itemWidth(t)*e},a.prototype._windowWidth=function(){return h(window).width()},a.prototype._getOptions=function(t){return h.extend(!0,{},u,t)},a._jQueryInterface=function(n,o,s,r){return this.each(function(){var t=h(this),e=t.data(c),i=h.extend(!0,{},u,t.data(),"object"==typeof n&&n);e||(e=new a(this,i),t.data(c,e)),"string"==typeof n&&e[n](o,s,r)})},h(document).on(e.START,n,function(t){m.set(t.originalEvent,this)}).on(e.OVER,i,function(t){var e=t.originalEvent,i=h(m.get(e));if(i.length){var n=e.touches?e.touches[0]:e,o=h(this),s=n.pageX-o.offset().left,r=n.pageY-o.offset().top,a=o[p]().data(c);t.preventDefault(),a._getMask(),a._moveGhost(i,s,r)}}).on(e.END,i,function(){h(this)[p]("end")}).on(e.LEAVE,i,function(t){t.preventDefault(),"mask"===h(t.target).data("lt-grid")&&h(this)[p]("end")}).on(e.DROP,i,function(t){var e=h(m.get(t.originalEvent));if(e.length){var i=h(this)[p]().data(c);t.preventDefault(),i._moveToGhost(e),i.end()}}),h.fn[p]=a._jQueryInterface,h.fn[p].LTGrid=a}(jQuery)),f=(e=jQuery,n={NAME:"ltRect",DATA_KEY:i="lt.rect"},e.fn.ltRect=function(t,e){return void 0===e?(void 0===this.data(i+t)&&this.data(i+t,(new g).loadCss(this.attr("class"),t)),this.data(i+t)):(this.data(i+t,e),this.attr("class",e.setCss(this.attr("class"),t)),this)},n),g=({NAME:"ltSize"},jQuery.fn.ltSize=function(){return this[a.NAME]().data(a.DATA_KEY).size()},function(){function t(t,e,i,n){this.x=t||0,this.y=e||0,this.w=i||1,this.h=n||1}var s=["x","y","w","h"];return t.prototype.bottom=function(){return this.y+this.h},t.prototype.right=function(){return this.x+this.w},t.prototype.intersect=function(t){return this.x<t.right()&&this.right()>t.x&&this.y<t.bottom()&&this.bottom()>t.y},t.prototype.setCss=function(e,i){var n=this;return s.forEach(function(t){e=e.replace(new RegExp("lt-"+i+"-"+t+"-(\\d+)"),"lt-"+i+"-"+t+"-"+n[t])}),e},t.prototype.loadCss=function(i,n){var o=this;return s.forEach(function(t){var e=i.match(new RegExp("lt-"+n+"-"+t+"-(\\d+)"));e&&(o[t]=parseInt(e[1],10))}),this},t}()),m={getRandomNumber:function(){return Math.round((new Date).getTime()+100*Math.random())},getId:function(t){return t.id||(t.id="lt-"+this.getRandomNumber()),t.id},clear:function(){this.item=null},set:function(t,e){this.item=JSON.stringify({LTWidget:this.getId(e)}),t.dataTransfer&&t.dataTransfer.setData("text",this.item)},get:function(t){var e=t.dataTransfer&&t.dataTransfer.getData("text")||this.item;if(e){var i=JSON.parse(e);return document.getElementById(i.LTWidget)}}};return a.Rect=g,a.Grid=d,a}(jQuery);