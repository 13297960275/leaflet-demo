
!function(_){"use strict";function C(t,o){return _.map(t,function(t){return t+".touchspin_"+o})}var D=0;_.fn.TouchSpin=function(g){if("destroy"!==g){var w={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalupclass:"glyphicon glyphicon-chevron-up",verticaldownclass:"glyphicon glyphicon-chevron-down",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-default",buttonup_class:"btn btn-default",buttondown_txt:"-",buttonup_txt:"+"},y={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){function e(){var t,o,n;return""===(t=h.val())?void(""!==c.replacementval&&(h.val(c.replacementval),h.trigger("change"))):void(0<c.decimals&&"."===t||(o=parseFloat(t),isNaN(o)&&(o=""!==c.replacementval?c.replacementval:0),(n=o).toString()!==t&&(n=o),o<c.min&&(n=c.min),o>c.max&&(n=c.max),n=function(t){switch(c.forcestepdivisibility){case"round":return(Math.round(t/c.step)*c.step).toFixed(c.decimals);case"floor":return(Math.floor(t/c.step)*c.step).toFixed(c.decimals);case"ceil":return(Math.ceil(t/c.step)*c.step).toFixed(c.decimals);default:return t}}(n),Number(t).toString()!==n.toString()&&(h.val(n),h.trigger("change"))))}function n(){if(c.booster){var t=Math.pow(2,Math.floor(m/c.boostat))*c.step;return c.maxboostedstep&&t>c.maxboostedstep&&(t=c.maxboostedstep,s=Math.round(s/t)*t),Math.max(c.step,t)}return c.step}function a(){e(),s=parseFloat(d.input.val()),isNaN(s)&&(s=0);var t=s,o=n();(s+=o)>c.max&&(s=c.max,h.trigger("touchspin.on.max"),r()),d.input.val(Number(s).toFixed(c.decimals)),t!==s&&h.trigger("change")}function i(){e(),s=parseFloat(d.input.val()),isNaN(s)&&(s=0);var t=s,o=n();(s-=o)<c.min&&(s=c.min,h.trigger("touchspin.on.min"),r()),d.input.val(s.toFixed(c.decimals)),t!==s&&h.trigger("change")}function p(){r(),m=0,x="down",h.trigger("touchspin.on.startspin"),h.trigger("touchspin.on.startdownspin"),f=setTimeout(function(){t=setInterval(function(){m++,i()},c.stepinterval)},c.stepintervaldelay)}function u(){r(),m=0,x="up",h.trigger("touchspin.on.startspin"),h.trigger("touchspin.on.startupspin"),b=setTimeout(function(){o=setInterval(function(){m++,a()},c.stepinterval)},c.stepintervaldelay)}function r(){switch(clearTimeout(f),clearTimeout(b),clearInterval(t),clearInterval(o),x){case"up":h.trigger("touchspin.on.stopupspin"),h.trigger("touchspin.on.stopspin");break;case"down":h.trigger("touchspin.on.stopdownspin"),h.trigger("touchspin.on.stopspin")}m=0,x=!1}var c,l,d,s,t,o,f,b,h=_(this),v=h.data(),m=0,x=!1;!function(){if(!h.data("alreadyinitialized")){if(h.data("alreadyinitialized",!0),D+=1,h.data("spinnerid",D),!h.is("input"))return console.log("Must be an input.");""!==(c=_.extend({},w,v,(s={},_.each(y,function(t,o){var n="bts-"+o;h.is("[data-"+n+"]")&&(s[t]=h.data(n))}),s),g)).initval&&""===h.val()&&h.val(c.initval),e(),t=h.val(),o=h.parent(),""!==t&&(t=Number(t).toFixed(c.decimals)),h.data("initvalue",t).val(t),h.addClass("form-control"),o.hasClass("input-group")?function(t){t.addClass("bootstrap-touchspin");var o,n,s=h.prev(),e=h.next(),a='<span class="input-group-addon bootstrap-touchspin-prefix">'+c.prefix+"</span>",i='<span class="input-group-addon bootstrap-touchspin-postfix">'+c.postfix+"</span>";s.hasClass("input-group-btn")?(o='<button class="'+c.buttondown_class+' bootstrap-touchspin-down" type="button">'+c.buttondown_txt+"</button>",s.append(o)):(o='<span class="input-group-btn"><button class="'+c.buttondown_class+' bootstrap-touchspin-down" type="button">'+c.buttondown_txt+"</button></span>",_(o).insertBefore(h)),e.hasClass("input-group-btn")?(n='<button class="'+c.buttonup_class+' bootstrap-touchspin-up" type="button">'+c.buttonup_txt+"</button>",e.prepend(n)):(n='<span class="input-group-btn"><button class="'+c.buttonup_class+' bootstrap-touchspin-up" type="button">'+c.buttonup_txt+"</button></span>",_(n).insertAfter(h)),_(a).insertBefore(h),_(i).insertAfter(h),l=t}(o):(n=c.verticalbuttons?'<div class="input-group bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+c.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+c.postfix+'</span><span class="input-group-btn-vertical"><button class="'+c.buttondown_class+' bootstrap-touchspin-up" type="button"><i class="'+c.verticalupclass+'"></i></button><button class="'+c.buttonup_class+' bootstrap-touchspin-down" type="button"><i class="'+c.verticaldownclass+'"></i></button></span></div>':'<div class="input-group bootstrap-touchspin"><span class="input-group-btn"><button class="'+c.buttondown_class+' bootstrap-touchspin-down" type="button">'+c.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix">'+c.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix">'+c.postfix+'</span><span class="input-group-btn"><button class="'+c.buttonup_class+' bootstrap-touchspin-up" type="button">'+c.buttonup_txt+"</button></span></div>",l=_(n).insertBefore(h),_(".bootstrap-touchspin-prefix",l).after(h),h.hasClass("input-sm")?l.addClass("input-group-sm"):h.hasClass("input-lg")&&l.addClass("input-group-lg")),d={down:_(".bootstrap-touchspin-down",l),up:_(".bootstrap-touchspin-up",l),input:_("input",l),prefix:_(".bootstrap-touchspin-prefix",l).addClass(c.prefix_extraclass),postfix:_(".bootstrap-touchspin-postfix",l).addClass(c.postfix_extraclass)},""===c.prefix&&d.prefix.hide(),""===c.postfix&&d.postfix.hide(),h.on("keydown",function(t){var o=t.keyCode||t.which;38===o?("up"!==x&&(a(),u()),t.preventDefault()):40===o&&("down"!==x&&(i(),p()),t.preventDefault())}),h.on("keyup",function(t){var o=t.keyCode||t.which;38===o?r():40===o&&r()}),h.on("blur",function(){e()}),d.down.on("keydown",function(t){var o=t.keyCode||t.which;(32===o||13===o)&&("down"!==x&&(i(),p()),t.preventDefault())}),d.down.on("keyup",function(t){var o=t.keyCode||t.which;(32===o||13===o)&&r()}),d.up.on("keydown",function(t){var o=t.keyCode||t.which;(32===o||13===o)&&("up"!==x&&(a(),u()),t.preventDefault())}),d.up.on("keyup",function(t){var o=t.keyCode||t.which;(32===o||13===o)&&r()}),d.down.on("mousedown.touchspin",function(t){d.down.off("touchstart.touchspin"),h.is(":disabled")||(i(),p(),t.preventDefault(),t.stopPropagation())}),d.down.on("touchstart.touchspin",function(t){d.down.off("mousedown.touchspin"),h.is(":disabled")||(i(),p(),t.preventDefault(),t.stopPropagation())}),d.up.on("mousedown.touchspin",function(t){d.up.off("touchstart.touchspin"),h.is(":disabled")||(a(),u(),t.preventDefault(),t.stopPropagation())}),d.up.on("touchstart.touchspin",function(t){d.up.off("mousedown.touchspin"),h.is(":disabled")||(a(),u(),t.preventDefault(),t.stopPropagation())}),d.up.on("mouseout touchleave touchend touchcancel",function(t){x&&(t.stopPropagation(),r())}),d.down.on("mouseout touchleave touchend touchcancel",function(t){x&&(t.stopPropagation(),r())}),d.down.on("mousemove touchmove",function(t){x&&(t.stopPropagation(),t.preventDefault())}),d.up.on("mousemove touchmove",function(t){x&&(t.stopPropagation(),t.preventDefault())}),_(document).on(C(["mouseup","touchend","touchcancel"],D).join(" "),function(t){x&&(t.preventDefault(),r())}),_(document).on(C(["mousemove","touchmove","scroll","scrollstart"],D).join(" "),function(t){x&&(t.preventDefault(),r())}),h.on("mousewheel DOMMouseScroll",function(t){if(c.mousewheel&&h.is(":focus")){var o=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),o<0?i():a()}}),h.on("touchspin.uponce",function(){r(),a()}),h.on("touchspin.downonce",function(){r(),i()}),h.on("touchspin.startupspin",function(){u()}),h.on("touchspin.startdownspin",function(){p()}),h.on("touchspin.stopspin",function(){r()}),h.on("touchspin.updatesettings",function(t,o){!function(t){var o;o=t,c=_.extend({},c,o),e();var n=d.input.val();""!==n&&(n=Number(d.input.val()),d.input.val(n.toFixed(c.decimals)))}(o)}),d.input.css("display","block")}var t,o,n,s}()})}this.each(function(){var t=_(this).data();_(document).off(C(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],t.spinnerid).join(" "))})}}(jQuery);