<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,layer,haoutil,mapV,leaflet-mars,esri-leaflet"></script><link href="css/style.css" rel="stylesheet"></head><body><div id="map" class="map"></div><script>var map;function initMap(){var t=haoutil.system.getRequestByName("config","config/gcj.json");L.mars.createMap({id:"map",url:t,success:function(t,a){map=t,initWork()}})}function initWork(){workMapV.create(map),workMapV.activate()}$(document).ready(function(){initMap()});var workMapV={layerWork:null,create:function(t){this.map=t,this.path="",this.layerWork=L.featureGroup()},activate:function(){map.changeBaseMap(1),map.addLayer(this.layerWork);var a=this;$.ajax({url:"../data/geojson/china.json",type:"GET",dataType:"json",success:function(t){a.showMapV(t)}})},disable:function(){map.changeBaseMap(0),map.removeLayer(this.layerWork)},showMapV:function(t){map.setView([33.468108,112.939453],5);for(var a=mapv.geojson.getDataSet(t),e="北京",o=new mapv.DataSet([{from:"河北",count:354551,to:e},{from:"天津",count:97323,to:e},{from:"山东",count:28664,to:e},{from:"山西",count:16650,to:e},{from:"辽宁",count:14379,to:e},{from:"河南",count:10980,to:e},{from:"内蒙古自治区",count:9603,to:e},{from:"江苏",count:4536,to:e},{from:"上海",count:3556,to:e},{from:"广东",count:2600,to:e}]).get(),r=[],n=[],i=[],s=[],m={},p=0;p<o.length;p++){var l=mapv.utilCityCenter.getCenterByCityName(o[p].from),u=mapv.utilCityCenter.getCenterByCityName(o[p].to);if(l&&u){m[o[p].from]=o[p].count,m[o[p].to]=100,n.push({geometry:{type:"Point",coordinates:[l.lng,l.lat]}}),n.push({geometry:{type:"Point",coordinates:[u.lng,u.lat]}}),i.push({geometry:{type:"Point",coordinates:[l.lng,l.lat]},text:o[p].from}),i.push({geometry:{type:"Point",coordinates:[u.lng,u.lat]},text:o[p].to});var c=mapv.utilCurve.getPoints([l,u]);for(j=0;j<c.length;j++)s.push({geometry:{type:"Point",coordinates:c[j]},count:1,time:j});r.push({geometry:{type:"LineString",coordinates:c},count:30*Math.random()})}}var y=a.get({filter:function(t){return!!m[t.name]&&(t.count=m[t.name],!0)}});a=new mapv.DataSet(y),L.mapVLayer(a,{gradient:{0:"rgba(55, 50, 250, 0.4)",1:"rgba(55, 50, 250, 1)"},max:354551,draw:"intensity"}).addTo(this.layerWork);var d=new mapv.DataSet(i);L.mapVLayer(d,{draw:"text",font:"14px Arial",fillStyle:"white",shadowColor:"yellow",shadowBlue:10,zIndex:11,shadowBlur:10}).addTo(this.layerWork);var g=new mapv.DataSet(r);L.mapVLayer(g,{strokeStyle:"rgba(255, 250, 50, 0.8)",shadowColor:"rgba(255, 250, 50, 1)",shadowBlur:20,lineWidth:2,zIndex:100,draw:"simple"}).addTo(this.layerWork);var h=new mapv.DataSet(n);L.mapVLayer(h,{fillStyle:"rgba(254,175,3,0.7)",shadowColor:"rgba(55, 50, 250, 0.5)",shadowBlur:10,size:5,zIndex:10,draw:"simple"}).addTo(this.layerWork);var f=new mapv.DataSet(s);L.mapVLayer(f,{fillStyle:"rgba(255, 250, 250, 0.5)",zIndex:200,size:2.5,animation:{type:"time",stepsRange:{start:0,end:50},trails:10,duration:2},draw:"simple"}).addTo(this.layerWork)}}</script></body></html>