
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,layer,haoutil,echarts-forleaflet,leaflet-src,esri-leaflet"></script><link href="css/style.css" rel="stylesheet"></head><body><div id="map" class="map"></div><script>var map;function initMap(){var t=haoutil.system.getRequestByName("config","config/gcj.json");L.src.createMap({id:"map",url:t,success:function(t,a){map=t,initWork()}})}function initWork(){workEcharts.create(map),workEcharts.activate()}$(document).ready(function(){initMap()});var workEcharts={layerWork:null,create:function(t){this.map=t,this.path=""},activate:function(){map.setView([30.652,107.661],5),map.changeBaseMap(1);var a=this;$.ajax({url:"../data/apidemo/weibo-echarts.json",type:"GET",dataType:"json",success:function(t){t=t.map(function(t,a){for(var e=t[0]/1e3,o=t[1]/1e3,r=[[e,o]],i=2;i<t.length;i+=2){var n=e+t[i]/1e3,s=o+t[i+1]/1e3;r.push([n.toFixed(2),s.toFixed(2),1]),e=n,o=s}return r}),a.showData(t)}})},disable:function(){map.removeLayer(this.layerWork),map.changeBaseMap(0),this.layerWork=null},showData:function(t){var a=this.getOption(t);null==this.layerWork?this.layerWork=L.flowEcharts(a).addTo(map):(this.layerWork._echartsOption=a,this.layerWork.redraw())},getOption:function(t){return option={backgroundColor:"rgba(17, 19, 42, 0.4)",title:{text:"人口数据",left:"center",top:"top",textStyle:{color:"#fff"}},tooltip:{},legend:{left:"right",data:["强","弱"],textStyle:{color:"#ccc"}},geo:{map:"",roam:!0},series:[{name:"弱",type:"scatter",coordinateSystem:"geo",symbolSize:1,large:!0,itemStyle:{normal:{shadowBlur:2,shadowColor:"rgba(14, 241, 242, 0.8)",color:"rgba(14, 241, 242, 0.8)"}},data:t[0]},{name:"强",type:"scatter",coordinateSystem:"geo",symbolSize:1,large:!0,itemStyle:{normal:{shadowBlur:2,shadowColor:"rgba(255, 255, 255, 0.8)",color:"rgba(255, 255, 255, 0.8)"}},data:t[1]}]},option}}</script></body></html>