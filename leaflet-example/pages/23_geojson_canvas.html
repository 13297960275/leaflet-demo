<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><link href="css/style.css" rel="stylesheet"><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,font-awesome,bootstrap,layer,haoutil,leaflet-mars,esri-leaflet"></script><script src="../lib/leafletPlugins/canvas-geojson/leaflet-canvas-geojson.js"></script></head><body><div id="map" class="map"></div><script>var map;function initMap(){var e=haoutil.system.getRequestByName("config","config/gcj.json");L.mars.createMap({id:"map",url:e,success:function(e,o){map=e,initWork()}})}function initWork(){map.setView([39.402244,116.499023],8),$.ajax({url:"../data/geojson/urban.json",type:"GET",dataType:"json",success:function(e){for(var o=0;o<e.features.length;o++){var t=e.features[o];1e3<t.properties.area_sqkm?t.properties.Color="rgba(100, 224, 60,.8)":t.properties.Color="rgba(100, 224, 60,.6)"}haoutil.msg("共渲染"+e.features.length+"个面"),showData(e)}})}function showData(e){var n=new L.CanvasGeojsonLayer({style:{},onClick:function(e,o){if(0!=e.length){var t="<table>",r=e[0].geojson.properties;for(var n in r){var a=$.trim(r[n]);null!=a&&""!=a&&"Null"!=a&&"Unknown"!=a&&"0"!=a&&0!=a.length&&(t+='<tr>  <td  style="text-align: right;min-width: 80px;">'+n+"：</td> <td>"+a+"</td>   </tr>")}t+="</table>";L.popup().setLatLng(o).setContent(t).openOn(map)}},onMouseOver:function(e,o){if(0!=e.length){for(var t=0;t<e.length;t++){var r=e[t].geojson.properties;r.Color_Old||(r.Color_Old=r.Color),r.Color="rgba(90, 131, 245, 1)"}n.render()}},onMouseOut:function(e,o){if(0!=e.length){for(var t=0;t<e.length;t++){var r=e[t].geojson.properties;r.Color=r.Color_Old}n.render()}}});n.addTo(map),n.addCanvasFeatures(L.CanvasFeatureFactory(e)),n.render()}$(document).ready(function(){initMap()})</script></body></html>