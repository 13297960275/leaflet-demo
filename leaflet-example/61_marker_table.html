
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,layer,haoutil,echarts-forleaflet,leaflet-mars,esri-leaflet"></script><link href="css/style.css" rel="stylesheet"></head><body><div id="map" class="map"></div><script>var map;function initMap(){var a=haoutil.system.getRequestByName("config","config/gcj.json");L.mars.createMap({id:"map",url:a,success:function(a,t){map=a,initWork()}})}function initWork(){workEcharts.create(map),workEcharts.activate()}$(document).ready(function(){initMap()});var workEcharts={layerWork:null,_arr_charts:[],create:function(a){this.map=a,this.path="",this.layerWork=L.featureGroup()},activate:function(){this.map.addLayer(this.layerWork);var t=this;$.getJSON("../data/apidemo/echarspoint.json",function(a){t.showData(a)})},disable:function(){this.clearLayers(),this.map.removeLayer(this.layerWork)},showData:function(a){this.clearLayers();for(var t=0;t<a.length;t++){var e=a[t];e._index=t,0!=e.TotalLength&&this.addmarker(e)}this.map.stop(),this.map.fitBounds(this.layerWork.getBounds())},addmarker:function(a){var t="port_"+a._index,e=(L.marker([a.Y,a.X],{icon:L.divIcon({className:"leaflet-echart-icon",iconSize:[220,220],html:'<div id="'+t+'" style="width: 220px; height: 220px; position: relative; background-color: transparent;"></div>'})}).addTo(this.layerWork),echarts.init(document.getElementById(t)));this._arr_charts.push(e),option={tooltip:{trigger:"axis"},xAxis:[{type:"category",data:["1月","2月","3月","4月"]}],yAxis:[{type:"value",name:"水量",min:0,max:50,interval:50,axisLabel:{formatter:"{value} ml"}},{type:"value",name:"温度",min:0,max:10,interval:5,axisLabel:{formatter:"{value} °C"}}],series:[{name:"蒸发量",type:"bar",data:[2,4.9,7,23.2]},{name:"降水量",type:"bar",data:[2.6,5.9,9,26.4]},{name:"平均温度",type:"line",yAxisIndex:1,data:[2,2.2,3.3,4.5]}]},e.setOption(option)},clearLayers:function(){for(var a=0;a<this._arr_charts.length;a++){this._arr_charts[a].dispose()}this._arr_charts=[],this.layerWork.clearLayers()}}</script></body></html>