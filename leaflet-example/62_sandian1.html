
<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0,minimum-scale=1,maximum-scale=1"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no"><meta name="x5-fullscreen" content="true"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><title>Leaflet地图</title><script src="../lib/include-lib.js" libpath="../lib/" include="jquery,layer,haoutil,echarts-forleaflet,leaflet-mars,esri-leaflet"></script><link href="css/style.css" rel="stylesheet"></head><body><div id="map" class="map"></div><script>var map;function initMap(){var a=haoutil.system.getRequestByName("config","config/gcj.json");L.mars.createMap({id:"map",url:a,success:function(a,o){map=a,initWork()}})}function initWork(){workEcharts.create(map),workEcharts.activate()}$(document).ready(function(){initMap()});var workEcharts={layerWork:null,create:function(a){this.map=a,this.path=""},activate:function(){this.showData([{name:"六安市",value:112,location:[116.3123,31.8329]},{name:"安庆市",value:424,location:[116.7517,30.5255]},{name:"滁州市",value:76,location:[118.1909,32.536]},{name:"宣城市",value:45,location:[118.8062,30.6244]},{name:"阜阳市",value:234,location:[115.7629,32.9919]},{name:"宿州市",value:110,location:[117.5208,33.6841]},{name:"黄山市",value:98,location:[118.0481,29.9542]},{name:"巢湖市",value:71,location:[117.7734,31.4978]},{name:"亳州市",value:165,location:[116.1914,33.4698]},{name:"池州市",value:12,location:[117.3889,30.2014]},{name:"合肥市",value:232,location:[117.29,32.0581]},{name:"蚌埠市",value:123,location:[117.4109,33.1073]},{name:"芜湖市",value:73,location:[118.3557,31.0858]},{name:"淮北市",value:16,location:[116.6968,33.6896]},{name:"淮南市",value:75,location:[116.7847,32.7722]},{name:"马鞍山市",value:45,location:[118.6304,31.5363]},{name:"铜陵市",value:93,location:[117.9382,30.9375]}],"#751b87")},disable:function(){map.removeLayer(this.layerWork),this.layerWork=null},showData:function(a,o){var t=this.getOption(a,o);null==this.layerWork?this.layerWork=L.flowEcharts(t).addTo(map):(this.layerWork._echartsOption=t,this.layerWork.redraw())},updateColor:function(a){null!=this.layerWork&&(this.layerWork._echartsOption.series[0].itemStyle.normal.color=a,this.layerWork.redraw())},getOption:function(a,o){if(1<a.length){a.sort(function(a,o){return o.location[1]-a.location[1]});for(var t=1;t<a.length;t++){for(var e=a[t].location,n=!1,i=0;i<t;i++){var r=a[i].location,l=Math.abs(r[0]-e[0]),c=Math.abs(r[1]-e[1]);if(l<.025&&c<.005){n=!0;break}}n&&(e[1]-=.006)}}var u=0,m=[],s=[];for(t=0;t<a.length;t++)u+=a[t].value,m.push({name:a[t].name,value:a[t].location.concat(a[t].value)}),s.push([a[t].location[1],a[t].location[0]]);return 0<s.length&&(map.stop(),map.fitBounds(s)),{backgroundColor:"rgba(238, 238, 238, 0.4)",animation:!0,animationDuration:1e3,animationEasing:"cubicInOut",animationDurationUpdate:1e3,animationEasingUpdate:"cubicInOut",geo:{map:"",roam:!0},tooltip:{trigger:"item"},series:[{type:"effectScatter",coordinateSystem:"geo",data:m,symbolSize:function(a){if(0==u)return 8;var o=a[2]/u*150;return Math.max(o,8)},showEffectOn:"render",rippleEffect:{brushType:"stroke"},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},tooltip:{formatter:function(a,o,t){return a.value[2]<=0?a.name:a.name+" ： "+a.value[2]}},itemStyle:{normal:{color:o,shadowBlur:60,shadowColor:"#cccccc"}},zlevel:1}]}}}</script></body></html>